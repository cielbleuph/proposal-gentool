<?php
    $DarkRedCellStyle = array(
        'bgColor' => $darkRed,
        'valign'=> 'center',
    );

    $lightRedCellStyle = array(
        'bgColor' => $lightRed
    );

    $methodologiesPage->addTitle('Vulnerability Assessment', 2); // TOC Bookmark 
    $methodologiesPage->addTextBreak();
    $methodologiesPage->addText('Fundamentals', $paragraphHeadingStyle, $paragraphHeadingPStyle);
    $methodologiesPage->addText('Red Team Partners offers Vulnerability Assessments. This service provides and assessment for vulnerabilities typically leveraged by malicious actors to gain a foothold into an organisation from an external point of view. Our Vulnerability Assessments also provides an insight into an organisation’s internet-facing assets and their security posture.', null, $defaultParagraphStyle);

    $methodologiesPage->addText("Red Team Partners collect information on the target from public web pages, newsgroups, search engines, employee public data and similar sources. We then use network scanners and vulnerability scanners to identify the target hosts. After identifying the hosts on the network that can be reached from outside the security perimeter, Red Team Partners attempt to compromise the hosts.", null, $defaultParagraphStyle);

    $methodologiesPage->addText("The primary objective of a Vulnerability Assessment is to identify exploitable vulnerabilities in networks, systems, hosts, applications, and network devices that allow hackers inside the company network or even take over the entire system.", null, $defaultParagraphStyle);

    $methodologiesPage->addText("A Vulnerability Assessment can be divided into four stages:", $boldText, $defaultParagraphStyle);
    $methodologiesPage->addListItem("Profiling", 0);
    $methodologiesPage->addListItem("Discovery", 0);
    $methodologiesPage->addListItem("Assessment", 0);
    $methodologiesPage->addTextBreak();


    // $methodologiesPage->addTextBreak();
    // $methodologiesPage->addText('A Vulnerability Scan can be divided into three stages:', null, $defaultParagraphStyle);

    // $methodologiesPage->addImage(
    //     ASSETS_IMG_DIR . 'methodologies/vulnerability-assessment-01.png',
    //     array(
    //         'width'         => 450,
    //         // 'height'        => 52,
    //         'marginTop'     => 2,
    //         'marginLeft'    => -1,
    //         'wrappingStyle' => 'behind',
    //         'alignment' => 'center',
    //     )
    // );

    $methodologiesPage->addText('Test Areas', $paragraphHeadingStyle, $paragraphHeadingPStyle);
    $methodologiesPage->addText('Profiling of an organisation’s Internet facing infrastructure is comprised mostly of non-invasive techniques, such as:', null, $defaultParagraphStyle);

    $methodologyVulnerabilityAssessmentATable = $methodologiesPage->addTable(
        array(
            'width' => 5000,
            'unit' => 'pct',
            'borderColor' => 'FFFFFF',
            'cellSpacing' => 5,
            'borderSize'=>1,
            'cellMargin' => 20
        )
    );
    
    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center') );
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText('DNS zone transfer attempts / DNS bruteforcing / DNS queries', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText(htmlspecialchars('Network Solutions & RIPE queries'), null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText('SSL examination', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText('Bounced e-mails to identify mail servers and IP ranges', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText('Open Source Intelligence gathering (OSINT)', null, array('indent'=>0.5));

    $methodologiesPage->addTextBreak();
    
    // $methodologiesPage->addText('Red Team Partners utilise a wide range of tools to further scan and discover assets. Our consultants use the latest scanning tools and techniques to perform a comprehensive audit on the IP ranges defined within the scope. Some of these include:');
    
    $methodologiesPage->addText('External Penetration Test', $paragraphHeadingStyle, $paragraphHeadingPStyle);
    
    // $methodologyVulnerabilityAssessmentBTable = $methodologiesPage->addTable(
    //     array(
    //         'width' => 5000,
    //         'unit' => 'pct',
    //         'borderColor' => 'FFFFFF',
    //         'cellSpacing' => 5,
    //         'borderSize'=>1,
    //         'cellMargin' => 20
    //     )
    // );

    $methodologiesPage->addText("Best method to simulate an actual external attack is to execute an External Penetration test. The security team is not provided with any real information about the target environment (other than IP address), and they must covertly collect information before the attack.", null, $defaultParagraphStyle);

    $methodologiesPage->addText("The testers collect information on the target from public web pages, newsgroups, search engines, employee public data and similar sources. They then use network scanners and vulnerability scanners to identify target hosts. After identifying hosts on the network that can be reached from outside the security perimeter, the testers attempt to compromise one of the hosts. If successful, they then leverage this access to compromise other hosts not generally accessible from outside the secure network.", null, $defaultParagraphStyle);

    $methodologiesPage->addText("The primary objective of an external penetration test is to identify exploitable vulnerabilities in networks, systems, hosts, applications, and network devices that allow hackers inside the company network or even take over the entire system.", null, $defaultParagraphStyle);

    $methodologiesPage->addText("The external penetration test consists of the following:", null, $defaultParagraphStyle);

    $methodologiesPage->addTextBreak();

    $methodologiesPage->addText("Test Name", $boldText, $defaultParagraphStyle);

    $vlTextRun1 = $methodologiesPage->addTextRun();
    $vlTextRun1->addText("Port Scanning and Enumeration:", $boldText);
    $vlTextRun1->addText(" In this phase, the security team probes system ports on the transport and network level of the target systems to enumerate live or accessible services");

    $vlTextRun2 = $methodologiesPage->addTextRun();
    $vlTextRun2->addText("Network authentication credentials gathering:", $boldText);
    $vlTextRun2->addText(" uses of passwords, remote access, encryption in use, plaintext passwords, cracking");

    $methodologiesPage->addListItem("DNS foot printing to detect public accessible domains", 0);
    $methodologiesPage->addListItem("SSH, VNC, Remote control exploit and brute-force", 0);
    
    $vlTextRun3 = $methodologiesPage->addTextRun();
    $vlTextRun3->addText("Running Automated Tools:", $boldText);
    $vlTextRun3->addText(" To uncover the Host/Application vulnerabilities, patch level and default user accounts/passwords.");

    $vlTextRun4 = $methodologiesPage->addTextRun();
    $vlTextRun4->addText("Verifying Authentication Methods:", $boldText);
    $vlTextRun4->addText(" Authentication methods in use with the systems/devices/application will be examined for their robustness to various subversion techniques.");

    $vlTextRun5 = $methodologiesPage->addTextRun();
    $vlTextRun5->addText("Default accounts in public services such as:", $boldText);
    $vlTextRun5->addText(" SSH, FTP, Telnet etc");

    $methodologiesPage->addListItem("Web server vulnerability misconfiguration exploits ", 0);

    $methodologiesPage->addListItem("Email server vulnerability detection, email pattern detection", 0);

    $methodologiesPage->addListItem("Phishing, interpreting as employees", 0);

    $vlTextRun6 = $methodologiesPage->addTextRun();
    $vlTextRun6->addText("ACL Verification:", $boldText);
    $vlTextRun6->addText(" Access controls lists of network devices will be tested by sending customized packets.");

    $methodologiesPage->addListItem("Exploiting vulnerabilities in applications discovered that may allow access to internal network", 0);

    $methodologiesPage->addListItem("SQL injections and Remote code execution in public applications", 0);

    $methodologiesPage->addListItem("Denial of Service to webservers, email server, network", 0);

    $vlTextRun7 = $methodologiesPage->addTextRun();
    $vlTextRun7->addText("Application Interaction:", $boldText);
    $vlTextRun7->addText(" Examination of application-to-application interaction between system components such as the web service, back-end data sources and any third-party developed components (e.g. ActiveX DLL libraries). Assessment of in-transit data between the client and server system by examining of data delivery methods and possibility of alteration.");

    
    $methodologiesPage->addListItem("Detection of external hosting, cloud services, buckets, code repositories, CDNs and check for known vulnerabilities.", 0);
    $methodologiesPage->addListItem("Verify all public IPs for applications, subdomains, opens services and vulnerabilities for each type of technology: mobile, web, IoT, web server, APIs.", 0);
    $methodologiesPage->addListItem("Access public Wi-Fi networks, access routers, exploit router vulnerabilities.", 0);
    $methodologiesPage->addListItem("Firewall configuration check and bypass techniques", 0);
    $methodologiesPage->addListItem("IDS assessment", 0);
    $methodologiesPage->addListItem("VPN assessment", 0);
    $methodologiesPage->addListItem("RPC Attacks", 0);
    $methodologiesPage->addListItem("Buffer overflow Attacks", 0);
    $methodologiesPage->addListItem("Web Server Attacks", 0);
    $methodologiesPage->addListItem("Mail Server Attacks", 0);



   
    // $methodologiesPage->addTextBreak();
    // $methodologiesPage->addText('Once the discovery phase has ended, Red Team Partners consultants interpret the results and use them to identify possible attack vectors and perform manual attack simulations.  Manual assessments focus on:', null, $defaultParagraphStyle);
    // $methodologiesPage->addTextBreak();

    // $methodologyVulnerabilityAssessmentCTable = $methodologiesPage->addTable(
    //     array(
    //         'width' => 5000,
    //         'unit' => 'pct',
    //         'borderColor' => 'FFFFFF',
    //         'cellSpacing' => 5,
    //         'borderSize'=>1,
    //         'cellMargin' => 20
    //     )
    // );
    
    // $methodologyVulnerabilityAssessmentCTable->addRow();
    // $methodologyVulnerabilityAssessmentCTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center') );
    // $methodologyVulnerabilityAssessmentCTable->addCell(null, $lightRedCellStyle)->addText('Misconfigured hosts and services', null, array('indent'=>0.5));

    // $methodologyVulnerabilityAssessmentCTable->addRow();
    // $methodologyVulnerabilityAssessmentCTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    // $methodologyVulnerabilityAssessmentCTable->addCell(null, $lightRedCellStyle)->addText('Outdated systems and software', null, array('indent'=>0.5));

    // $methodologyVulnerabilityAssessmentCTable->addRow();
    // $methodologyVulnerabilityAssessmentCTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    // $methodologyVulnerabilityAssessmentCTable->addCell(null, $lightRedCellStyle)->addText('Insecure protocols', null, array('indent'=>0.5));

    // $methodologyVulnerabilityAssessmentCTable->addRow();
    // $methodologyVulnerabilityAssessmentCTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    // $methodologyVulnerabilityAssessmentCTable->addCell(null, $lightRedCellStyle)->addText('Weak passwords and default usernames', null, array('indent'=>0.5));

    // $methodologiesPage->addTextBreak();

    $methodologiesPage->addPageBreak();