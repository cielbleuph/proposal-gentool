<?php
    $DarkRedCellStyle = array(
        'bgColor' => $darkRed,
        'valign'=> 'center',
    );

    $lightRedCellStyle = array(
        'bgColor' => $lightRed
    );

    $methodologiesPage->addTitle('Vulnerability Assessment', 2); // TOC Bookmark 
    $methodologiesPage->addTextBreak();
    $methodologiesPage->addText('Fundamentals', $paragraphHeadingStyle, $paragraphHeadingPStyle);
    $methodologiesPage->addText('Red Team Partners offers Vulnerability Assessments. This service provides and assessment for vulnerabilities typically leveraged by malicious actors to gain a foothold into an organisation from an external point of view. Our Vulnerability Assessments also provides an insight into an organisation’s internet-facing assets and their security posture.', null, $defaultParagraphStyle);

    $methodologiesPage->addText("Red Team Partners collect information on the target from public web pages, newsgroups, search engines, employee public data and similar sources. We then use network scanners and vulnerability scanners to identify the target hosts. After identifying the hosts on the network that can be reached from outside the security perimeter, Red Team Partners attempt to compromise the hosts.", null, $defaultParagraphStyle);

    $methodologiesPage->addText("The primary objective of a Vulnerability Assessment is to identify exploitable vulnerabilities in networks, systems, hosts, applications, and network devices that allow hackers inside the company network or even take over the entire system.", null, $defaultParagraphStyle);



    // $methodologiesPage->addTextBreak();
    // $methodologiesPage->addText('A Vulnerability Scan can be divided into three stages:', null, $defaultParagraphStyle);

    // $methodologiesPage->addImage(
    //     ASSETS_IMG_DIR . 'methodologies/vulnerability-assessment-01.png',
    //     array(
    //         'width'         => 450,
    //         // 'height'        => 52,
    //         'marginTop'     => 2,
    //         'marginLeft'    => -1,
    //         'wrappingStyle' => 'behind',
    //         'alignment' => 'center',
    //     )
    // );

    $methodologiesPage->addText('Test Areas', $paragraphHeadingStyle, $paragraphHeadingPStyle);
    $methodologiesPage->addText('Profiling of an organisation’s Internet facing infrastructure is comprised mostly of non-invasive techniques, such as:', null, $defaultParagraphStyle);

    $methodologyVulnerabilityAssessmentATable = $methodologiesPage->addTable(
        array(
            'width' => 5000,
            'unit' => 'pct',
            'borderColor' => 'FFFFFF',
            'cellSpacing' => 5,
            'borderSize'=>1,
            'cellMargin' => 20
        )
    );
    
    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center') );
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText('DNS zone transfer attempts / DNS bruteforcing / DNS queries', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText(htmlspecialchars('Network Solutions & RIPE queries'), null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText('SSL examination', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText('Bounced e-mails to identify mail servers and IP ranges', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentATable->addRow();
    $methodologyVulnerabilityAssessmentATable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentATable->addCell(null, $lightRedCellStyle)->addText('Open Source Intelligence gathering (OSINT)', null, array('indent'=>0.5));

    $methodologiesPage->addTextBreak();
    $methodologiesPage->addText('Red Team Partners utilise a wide range of tools to further scan and discover assets. Our consultants use the latest scanning tools and techniques to perform a comprehensive audit on the IP ranges defined within the scope. Some of these include:');
    
    
    $methodologyVulnerabilityAssessmentBTable = $methodologiesPage->addTable(
        array(
            'width' => 5000,
            'unit' => 'pct',
            'borderColor' => 'FFFFFF',
            'cellSpacing' => 5,
            'borderSize'=>1,
            'cellMargin' => 20
        )
    );
    
    $methodologyVulnerabilityAssessmentBTable->addRow();
    $methodologyVulnerabilityAssessmentBTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center') );
    $methodologyVulnerabilityAssessmentBTable->addCell(null, $lightRedCellStyle)->addText('TCP and UDP port scanning', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentBTable->addRow();
    $methodologyVulnerabilityAssessmentBTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentBTable->addCell(null, $lightRedCellStyle)->addText(htmlspecialchars('Operating system & service fingerprinting'), null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentBTable->addRow();
    $methodologyVulnerabilityAssessmentBTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentBTable->addCell(null, $lightRedCellStyle)->addText('Network mapping', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentBTable->addRow();
    $methodologyVulnerabilityAssessmentBTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentBTable->addCell(null, $lightRedCellStyle)->addText('User enumeration (where possible)', null, array('indent'=>0.5));

   
    $methodologiesPage->addTextBreak();
    $methodologiesPage->addText('Once the discovery phase has ended, Red Team Partners consultants interpret the results and use them to identify possible attack vectors and perform manual attack simulations.  Manual assessments focus on:', null, $defaultParagraphStyle);
    $methodologiesPage->addTextBreak();

    $methodologyVulnerabilityAssessmentCTable = $methodologiesPage->addTable(
        array(
            'width' => 5000,
            'unit' => 'pct',
            'borderColor' => 'FFFFFF',
            'cellSpacing' => 5,
            'borderSize'=>1,
            'cellMargin' => 20
        )
    );
    
    $methodologyVulnerabilityAssessmentCTable->addRow();
    $methodologyVulnerabilityAssessmentCTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center') );
    $methodologyVulnerabilityAssessmentCTable->addCell(null, $lightRedCellStyle)->addText('Misconfigured hosts and services', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentCTable->addRow();
    $methodologyVulnerabilityAssessmentCTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentCTable->addCell(null, $lightRedCellStyle)->addText('Outdated systems and software', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentCTable->addRow();
    $methodologyVulnerabilityAssessmentCTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentCTable->addCell(null, $lightRedCellStyle)->addText('Insecure protocols', null, array('indent'=>0.5));

    $methodologyVulnerabilityAssessmentCTable->addRow();
    $methodologyVulnerabilityAssessmentCTable->addCell(450, $DarkRedCellStyle)->addText('-', array('color'=>'FFFFFF'), array('alignment'=>'center'));
    $methodologyVulnerabilityAssessmentCTable->addCell(null, $lightRedCellStyle)->addText('Weak passwords and default usernames', null, array('indent'=>0.5));

    $methodologiesPage->addTextBreak();